<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n L√Ω Khu Ph·ªë Th√¥ng Minh</title>
    <meta name="description" content="H·ªá th·ªëng qu·∫£n l√Ω khu ph·ªë th√¥ng minh - Khu ph·ªë 25 Long Tr∆∞·ªùng">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/components.css">
    <link rel="stylesheet" href="/css/responsive.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <!-- Login Screen -->
    <div id="login-screen" class="login-screen">
        <div class="login-container">
            <div class="login-header">
                <div class="login-logo">
                    <span class="logo-icon">üèòÔ∏è</span>
                </div>
                <h1 class="login-title">Khu Ph·ªë Th√¥ng Minh</h1>
                <p class="login-subtitle" id="neighborhood-name">Khu ph·ªë 25 - Long Tr∆∞·ªùng</p>
            </div>
            <form id="login-form" class="login-form">
                <div class="form-group">
                    <label for="username">T√™n ƒëƒÉng nh·∫≠p</label>
                    <div class="input-wrapper">
                        <span class="input-icon">üë§</span>
                        <input type="text" id="username" name="username" placeholder="Nh·∫≠p t√™n ƒëƒÉng nh·∫≠p" required
                            autocomplete="username">
                    </div>
                </div>
                <div class="form-group">
                    <label for="password">M·∫≠t kh·∫©u</label>
                    <div class="input-wrapper">
                        <span class="input-icon">üîí</span>
                        <input type="password" id="password" name="password" placeholder="Nh·∫≠p m·∫≠t kh·∫©u" required
                            autocomplete="current-password">
                        <button type="button" class="toggle-password" tabindex="-1">üëÅÔ∏è</button>
                    </div>
                </div>
                <div id="login-error" class="error-message" style="display: none;"></div>
                <button type="submit" class="btn btn-primary btn-lg btn-block" id="login-btn">
                    <span class="btn-text">ƒêƒÉng nh·∫≠p</span>
                    <span class="btn-loader" style="display: none;"></span>
                </button>
            </form>
            <div class="login-footer">
                <p>Ph∆∞·ªùng Long Tr∆∞·ªùng - TP. Th·ªß ƒê·ª©c - TP.HCM</p>
            </div>
        </div>
        <div class="login-bg-shapes">
            <div class="shape shape-1"></div>
            <div class="shape shape-2"></div>
            <div class="shape shape-3"></div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="app" class="app" style="display: none;">
        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <span class="logo-icon">üèòÔ∏è</span>
                    <span class="logo-text" id="sidebar-title">Khu ph·ªë 25</span>
                </div>
                <button id="sidebar-toggle" class="sidebar-toggle">
                    <span></span>
                </button>
            </div>
            <nav class="sidebar-nav">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a href="#dashboard" class="nav-link active" data-page="dashboard">
                            <span class="nav-icon">üìä</span>
                            <span class="nav-text">T·ªïng quan</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#households" class="nav-link" data-page="households">
                            <span class="nav-icon">üè†</span>
                            <span class="nav-text">H·ªô d√¢n</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#residents" class="nav-link" data-page="residents">
                            <span class="nav-icon">üë•</span>
                            <span class="nav-text">Nh√¢n kh·∫©u</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#notifications" class="nav-link" data-page="notifications">
                            <span class="nav-icon">üì¢</span>
                            <span class="nav-text">Th√¥ng b√°o</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#statistics" class="nav-link" data-page="statistics">
                            <span class="nav-icon">üìà</span>
                            <span class="nav-text">Th·ªëng k√™</span>
                        </a>
                    </li>
                    <li class="nav-item nav-item-admin" style="display: none;">
                        <a href="#users" class="nav-link" data-page="users">
                            <span class="nav-icon">üëî</span>
                            <span class="nav-text">Ng∆∞·ªùi d√πng</span>
                        </a>
                    </li>
                    <li class="nav-item nav-item-settings" style="display: none;">
                        <a href="#settings" class="nav-link" data-page="settings">
                            <span class="nav-icon">‚öôÔ∏è</span>
                            <span class="nav-text">C√†i ƒë·∫∑t</span>
                        </a>
                    </li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <div class="user-info">
                    <div class="user-avatar" id="user-avatar">A</div>
                    <div class="user-details">
                        <span class="user-name" id="user-name">Admin</span>
                        <span class="user-role" id="user-role">Qu·∫£n tr·ªã vi√™n</span>
                    </div>
                </div>
                <button id="logout-btn" class="btn btn-outline btn-sm">ƒêƒÉng xu·∫•t</button>
            </div>
        </aside>

        <!-- Main Content -->
        <main id="main-content" class="main-content">
            <!-- Header -->
            <header class="main-header">
                <div class="header-left">
                    <button id="mobile-menu-toggle" class="mobile-menu-toggle">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                    <h1 class="page-title" id="page-title">T·ªïng quan</h1>
                </div>
                <div class="header-right">
                    <div class="search-box">
                        <input type="text" id="global-search" placeholder="T√¨m ki·∫øm..." class="search-input">
                        <span class="search-icon">üîç</span>
                    </div>
                    <button id="ai-search-btn" class="ai-search-btn" title="T√¨m ki·∫øm AI">
                        <span>ü§ñ</span>
                        <span>AI</span>
                    </button>
                    <button id="theme-toggle" class="theme-toggle" title="ƒê·ªïi giao di·ªán">
                        <span class="theme-icon">üåô</span>
                    </button>
                    <button id="notification-bell" class="notification-bell" title="Th√¥ng b√°o">
                        <span class="bell-icon">üîî</span>
                        <span class="notification-badge" id="notification-badge" style="display: none;">0</span>
                    </button>
                </div>
            </header>

            <!-- Page Content -->
            <div id="page-content" class="page-content">
                <!-- Dashboard Page -->
                <div id="page-dashboard" class="page active">
                    <div class="stats-grid">
                        <div class="stat-card stat-card-gradient-1">
                            <div class="stat-icon">üè†</div>
                            <div class="stat-info">
                                <span class="stat-value" id="stat-households">0</span>
                                <span class="stat-label">H·ªô d√¢n</span>
                            </div>
                        </div>
                        <div class="stat-card stat-card-gradient-2">
                            <div class="stat-icon">üë•</div>
                            <div class="stat-info">
                                <span class="stat-value" id="stat-residents">0</span>
                                <span class="stat-label">Nh√¢n kh·∫©u</span>
                            </div>
                        </div>
                        <div class="stat-card stat-card-gradient-3">
                            <div class="stat-icon">üì¢</div>
                            <div class="stat-info">
                                <span class="stat-value" id="stat-notifications">0</span>
                                <span class="stat-label">Th√¥ng b√°o</span>
                            </div>
                        </div>
                        <div class="stat-card stat-card-gradient-4">
                            <div class="stat-icon">üìã</div>
                            <div class="stat-info">
                                <span class="stat-value" id="stat-temp-residents">0</span>
                                <span class="stat-label">T·∫°m tr√∫</span>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-grid">
                        <div class="card chart-card">
                            <div class="card-header">
                                <h3 class="card-title">Ph√¢n b·ªë ƒë·ªô tu·ªïi</h3>
                            </div>
                            <div class="card-body">
                                <canvas id="age-chart"></canvas>
                            </div>
                        </div>
                        <div class="card chart-card">
                            <div class="card-header">
                                <h3 class="card-title">Gi·ªõi t√≠nh</h3>
                            </div>
                            <div class="card-body">
                                <canvas id="gender-chart"></canvas>
                            </div>
                        </div>
                        <div class="card notifications-card">
                            <div class="card-header">
                                <h3 class="card-title">Th√¥ng b√°o m·ªõi</h3>
                                <a href="#notifications" class="card-link" data-page="notifications">Xem t·∫•t c·∫£</a>
                            </div>
                            <div class="card-body">
                                <div id="latest-notifications" class="notification-list">
                                    <!-- Dynamic content -->
                                </div>
                            </div>
                        </div>
                        <div class="card activity-card">
                            <div class="card-header">
                                <h3 class="card-title">Ho·∫°t ƒë·ªông g·∫ßn ƒë√¢y</h3>
                            </div>
                            <div class="card-body">
                                <div id="recent-activity" class="activity-list">
                                    <!-- Dynamic content -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Households Page -->
                <div id="page-households" class="page">
                    <div class="page-header">
                        <div class="page-actions">
                            <div class="search-filter">
                                <input type="text" id="household-search" placeholder="T√¨m ki·∫øm h·ªô d√¢n..."
                                    class="search-input">
                                <select id="household-area-filter" class="select-input">
                                    <option value="">T·∫•t c·∫£ khu v·ª±c</option>
                                </select>
                                <select id="household-type-filter" class="select-input">
                                    <option value="">T·∫•t c·∫£ lo·∫°i h·ªô</option>
                                    <option value="permanent">Th∆∞·ªùng tr√∫</option>
                                    <option value="temporary">T·∫°m tr√∫</option>
                                </select>
                                <select id="household-status-filter" class="select-input">
                                    <option value="">T·∫•t c·∫£ t√¨nh tr·∫°ng</option>
                                    <option value="normal">H·ªô th∆∞·ªùng</option>
                                    <option value="business">H·ªô kinh doanh</option>
                                    <option value="rental">H·ªô cho thu√™</option>
                                    <option value="poor">H·ªô ngh√®o</option>
                                    <option value="near_poor">H·ªô c·∫≠n ngh√®o</option>
                                    <option value="policy">Gia ƒë√¨nh ch√≠nh s√°ch</option>
                                </select>
                            </div>
                            <button id="add-household-btn" class="btn btn-primary btn-icon">
                                <span>‚ûï</span>
                                <span>Th√™m h·ªô d√¢n</span>
                            </button>
                        </div>
                    </div>
                    <div class="table-container">
                        <table class="data-table" id="households-table">
                            <thead>
                                <tr>
                                    <th>M√£ h·ªô kh·∫©u</th>
                                    <th>ƒê·ªãa ch·ªâ</th>
                                    <th>Ch·ªß h·ªô</th>
                                    <th>S·ªë th√†nh vi√™n</th>
                                    <th>Lo·∫°i h·ªô</th>
                                    <th>T√¨nh tr·∫°ng</th>
                                    <th>Thao t√°c</th>
                                </tr>
                            </thead>
                            <tbody id="households-tbody">
                                <!-- Dynamic content -->
                            </tbody>
                        </table>
                    </div>
                    <div id="households-pagination" class="pagination"></div>
                </div>

                <!-- Residents Page -->
                <div id="page-residents" class="page">
                    <div class="page-header">
                        <div class="page-actions">
                            <div class="search-filter">
                                <input type="text" id="resident-search" placeholder="T√¨m ki·∫øm nh√¢n kh·∫©u..."
                                    class="search-input">
                                <select id="resident-gender-filter" class="select-input">
                                    <option value="">T·∫•t c·∫£ gi·ªõi t√≠nh</option>
                                    <option value="Nam">Nam</option>
                                    <option value="N·ªØ">N·ªØ</option>
                                </select>
                                <select id="resident-type-filter" class="select-input">
                                    <option value="">T·∫•t c·∫£ lo·∫°i</option>
                                    <option value="permanent">Th∆∞·ªùng tr√∫</option>
                                    <option value="temporary">T·∫°m tr√∫</option>
                                </select>
                            </div>
                            <button id="add-resident-btn" class="btn btn-primary btn-icon">
                                <span>‚ûï</span>
                                <span>Th√™m nh√¢n kh·∫©u</span>
                            </button>
                        </div>
                    </div>
                    <div class="table-container">
                        <table class="data-table" id="residents-table">
                            <thead>
                                <tr>
                                    <th>H·ªç t√™n</th>
                                    <th>NƒÉm sinh</th>
                                    <th>Gi·ªõi t√≠nh</th>
                                    <th>M√£ h·ªô kh·∫©u</th>
                                    <th>Quan h·ªá</th>
                                    <th>N∆°i ·ªü hi·ªán nay</th>
                                    <th>Thao t√°c</th>
                                </tr>
                            </thead>
                            <tbody id="residents-tbody">
                                <!-- Dynamic content -->
                            </tbody>
                        </table>
                    </div>
                    <div id="residents-pagination" class="pagination"></div>
                </div>

                <!-- Notifications Page -->
                <div id="page-notifications" class="page">
                    <div class="page-header">
                        <div class="page-actions">
                            <div class="search-filter">
                                <select id="notification-type-filter" class="select-input">
                                    <option value="">T·∫•t c·∫£ lo·∫°i</option>
                                    <option value="general">Chung</option>
                                    <option value="fee">Thu ph√≠</option>
                                    <option value="meeting">H·ªçp</option>
                                    <option value="event">S·ª± ki·ªán</option>
                                </select>
                            </div>
                            <button id="add-notification-btn" class="btn btn-primary btn-icon" style="display: none;">
                                <span>‚ûï</span>
                                <span>Th√™m th√¥ng b√°o</span>
                            </button>
                        </div>
                    </div>
                    <div id="notifications-list" class="notifications-grid">
                        <!-- Dynamic content -->
                    </div>
                    <div id="notifications-pagination" class="pagination"></div>
                </div>

                <!-- Statistics Page -->
                <div id="page-statistics" class="page">
                    <div class="stats-page-grid">
                        <div class="card full-width">
                            <div class="card-header">
                                <h3 class="card-title">Th·ªëng k√™ theo th·ªùi gian</h3>
                            </div>
                            <div class="card-body">
                                <canvas id="timeline-chart"></canvas>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Ngh·ªÅ nghi·ªáp ph·ªï bi·∫øn</h3>
                            </div>
                            <div class="card-body">
                                <canvas id="occupation-chart"></canvas>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">T√¨nh tr·∫°ng h·ªô</h3>
                            </div>
                            <div class="card-body">
                                <canvas id="household-status-chart"></canvas>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Quy m√¥ h·ªô gia ƒë√¨nh</h3>
                            </div>
                            <div class="card-body">
                                <canvas id="household-size-chart"></canvas>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Tr√¨nh ƒë·ªô h·ªçc v·∫•n</h3>
                            </div>
                            <div class="card-body">
                                <canvas id="education-chart"></canvas>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Ph√¢n b·ªë theo khu v·ª±c</h3>
                            </div>
                            <div class="card-body">
                                <canvas id="area-chart"></canvas>
                            </div>
                        </div>
                        <div class="card full-width">
                            <div class="card-header"
                                style="display: flex; justify-content: space-between; align-items: center;">
                                <h3 class="card-title">ü§ñ Ph√¢n t√≠ch AI</h3>
                                <button id="refresh-ai-insights" class="btn btn-sm btn-secondary">
                                    <span>üîÑ</span> Ph√¢n t√≠ch
                                </button>
                            </div>
                            <div class="card-body" id="ai-insights-container">
                                <div class="empty-state" style="padding: 2rem;">
                                    <p>Nh·∫•n n√∫t "Ph√¢n t√≠ch" ƒë·ªÉ AI ph√¢n t√≠ch d·ªØ li·ªáu d√¢n c∆∞</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Users Page (Admin only) -->
                <div id="page-users" class="page">
                    <div class="page-header">
                        <div class="page-actions">
                            <button id="add-user-btn" class="btn btn-primary btn-icon">
                                <span>‚ûï</span>
                                <span>Th√™m ng∆∞·ªùi d√πng</span>
                            </button>
                        </div>
                    </div>
                    <div class="table-container">
                        <table class="data-table" id="users-table">
                            <thead>
                                <tr>
                                    <th>T√™n ƒëƒÉng nh·∫≠p</th>
                                    <th>H·ªç t√™n</th>
                                    <th>Vai tr√≤</th>
                                    <th>Email</th>
                                    <th>ƒêi·ªán tho·∫°i</th>
                                    <th>Tr·∫°ng th√°i</th>
                                    <th>Thao t√°c</th>
                                </tr>
                            </thead>
                            <tbody id="users-tbody">
                                <!-- Dynamic content -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Settings Page -->
                <div id="page-settings" class="page">
                    <div class="settings-container">
                        <!-- API Key Card - Hi·ªÉn th·ªã cho t·∫•t c·∫£ user -->
                        <div class="card" style="margin-bottom: 1.5rem;">
                            <div class="card-header">
                                <h3 class="card-title">ü§ñ C·∫•u h√¨nh Gemini AI</h3>
                            </div>
                            <div class="card-body">
                                <p style="margin-bottom: 1rem; color: var(--text-secondary); font-size: 0.9rem;">
                                    ƒê·ªÉ s·ª≠ d·ª•ng t√≠nh nƒÉng AI (Tr·ª£ l√Ω AI, T√¨m ki·∫øm th√¥ng minh, Ph√¢n t√≠ch d·ªØ li·ªáu), 
                                    b·∫°n c·∫ßn nh·∫≠p Gemini API Key c·ªßa ri√™ng m√¨nh.
                                </p>
                                <div class="form-group">
                                    <label for="gemini-api-key">Gemini API Key</label>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <input type="password" id="gemini-api-key" class="form-input" 
                                            placeholder="AIza..." style="flex: 1;">
                                        <button type="button" id="toggle-api-key" class="btn btn-secondary" title="Hi·ªán/·∫®n">üëÅÔ∏è</button>
                                    </div>
                                    <p class="form-hint" style="margin-top: 0.5rem;">
                                        <span id="api-key-status" style="color: var(--warning-500);">‚ö†Ô∏è Ch∆∞a c·∫•u h√¨nh</span>
                                    </p>
                                </div>
                                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                    <button type="button" id="save-api-key" class="btn btn-primary">üíæ L∆∞u API Key</button>
                                    <button type="button" id="clear-api-key" class="btn btn-danger">üóëÔ∏è X√≥a API Key</button>
                                    <a href="https://aistudio.google.com/apikey" target="_blank" class="btn btn-secondary">
                                        üîë L·∫•y API Key mi·ªÖn ph√≠
                                    </a>
                                </div>
                            </div>
                        </div>

                        <!-- Th√¥ng tin khu ph·ªë - Ch·ªâ Admin/Chief th·∫•y -->
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Th√¥ng tin khu ph·ªë</h3>
                            </div>
                            <div class="card-body">
                                <form id="settings-form" class="settings-form">
                                    <div class="form-group">
                                        <label for="setting-neighborhood-name">T√™n khu ph·ªë</label>
                                        <input type="text" id="setting-neighborhood-name" class="form-input">
                                    </div>
                                    <div class="form-group">
                                        <label for="setting-ward-name">Ph∆∞·ªùng</label>
                                        <input type="text" id="setting-ward-name" class="form-input">
                                    </div>
                                    <div class="form-group">
                                        <label for="setting-district-name">Qu·∫≠n/TP</label>
                                        <input type="text" id="setting-district-name" class="form-input">
                                    </div>
                                    <div class="form-group">
                                        <label for="setting-city-name">T·ªânh/Th√†nh ph·ªë</label>
                                        <input type="text" id="setting-city-name" class="form-input">
                                    </div>
                                    <div class="form-group">
                                        <label for="setting-contact-phone">ƒêi·ªán tho·∫°i li√™n h·ªá</label>
                                        <input type="tel" id="setting-contact-phone" class="form-input">
                                    </div>
                                    <div class="form-group">
                                        <label for="setting-contact-email">Email li√™n h·ªá</label>
                                        <input type="email" id="setting-contact-email" class="form-input">
                                    </div>
                                    <button type="submit" class="btn btn-primary">L∆∞u c√†i ƒë·∫∑t</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal Template -->
    <div id="modal" class="modal">
        <div class="modal-overlay" id="modal-overlay"></div>
        <div class="modal-container" id="modal-container">
            <div class="modal-header">
                <h2 class="modal-title" id="modal-title">Modal Title</h2>
                <button class="modal-close" id="modal-close">√ó</button>
            </div>
            <div class="modal-body" id="modal-body">
                <!-- Dynamic content -->
            </div>
            <div class="modal-footer" id="modal-footer">
                <!-- Dynamic buttons -->
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Scripts -->
    <script src="/js/api.js"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/app.js"></script>
    <script src="/js/dashboard.js"></script>
    <script src="/js/household.js"></script>
    <script src="/js/resident.js"></script>
    <script src="/js/notification.js"></script>
    <script src="/js/statistics.js"></script>
    <script src="/js/chatbot.js"></script>
</body>

</html>